<ng-container>
  <app-breadcrumb [breadcrumbRoutes]="breadcrumbRoutes" class="breadcrumb"></app-breadcrumb>
  <p *ngIf="user$ | async as user" class="user-msg"><strong>Usuario: </strong> {{' ' +user.name}}
    <button (click)="logout()" class="logout-btn" title="Cerrar sesiÃ³n">
      <i class="fas fa-sign-out-alt"></i>
    </button>
  </p>
  <section class="orders-wrapper">
    <div class="title-container">
      <h2 class="orders-title">Pedidos</h2>
      <button class="new-order" (click)="openNewOrderDialog()" title="Nuevo pedido">
        <i class="fa-solid fa-file-circle-plus"></i>
      </button>
    </div>
    <div class="filter-panel">
      <ng-container *ngIf="filter$ | async as filter">
        <div class="filter-tag" [ngClass]="{'active': filter === 'Pendiente'}" (click)="setFilter('Pendiente')">
          Pendientes</div>
        <div class="filter-tag" [ngClass]="{'active': filter === 'Pendiente de entrega'}"
          (click)="setFilter('Pendiente de entrega')">Pendientes de entrega</div>
        <div class="filter-tag" [ngClass]="{'active': filter === 'Pendiente de cobro'}"
          (click)="setFilter('Pendiente de cobro')">Pendientes de cobro</div>
        <div class="filter-tag" [ngClass]="{'active': filter === 'Entregado y cobrado'}"
          (click)="setFilter('Entregado y cobrado')">Entregados y cobrados</div>
        <div class="filter-tag" [ngClass]="{'active': filter === 'Anulado'}" (click)="setFilter('Anulado')">Anulados
        </div>
      </ng-container>
    </div>
    <div class="container">
      <ng-container *ngIf="paginatedOrders$ | async as data; else skeletonList">
        <ng-container *ngIf="data.orders.length > 0; else noOrders">
          @for(order of data.orders; track order.idOrder) {
          <app-order-card [order]="order"></app-order-card>
          }

        </ng-container>
      </ng-container>
    </div>
    <ng-container *ngIf="(paginatedOrders$ | async) as data">
      <ng-container *ngIf="data.orders.length > 0">
        <!-- ðŸ”¹ Paginador -->
        <div class="pagination-controls">
          <button class="page-btn" (click)="prevPage()" [disabled]="data.page === 1" title="PÃ¡gina anterior">
            â—€
          </button>
      
          <span class="page-info">
            PÃ¡gina {{ data.page }} de {{ data.totalPages }}
          </span>
      
          <button class="page-btn" (click)="nextPage()" [disabled]="data.page === data.totalPages"
            title="PÃ¡gina siguiente">
            â–¶
          </button>
        </div>
      </ng-container>
    </ng-container>
  </section>
  
</ng-container>

<ng-template #skeletonList>
  <div class="skeleton-container">
    <div class="skeleton-card" *ngFor="let i of [1,2,3,4]">
      <div class="skeleton-title"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line short"></div>
    </div>
  </div>
</ng-template>

<ng-template #noOrders>
  <div class="no-orders-msg">
    No hay pedidos en el filtro seleccionado.
  </div>
</ng-template>

<app-order-form></app-order-form>